# 20240907 [TIL]  

<br>

---
<br>
<br>
<br>

```
 - 
 
```

**서킷 브레이커(Circuit Breaker)** 는 분산 시스템이나 마이크로서비스 아키텍처(MSA)에서 사용하는 실패 처리 패턴 중 하나입니다. 이 패턴은 특정 서비스에 대한 호출 실패가 발생할 때, 시스템 전체에 영향을 주지 않고 실패를 격리하기 위한 메커니즘입니다.

서킷 브레이커는 실제 전기 회로 차단기와 비슷하게 동작합니다. 서비스 간의 호출에서 장애가 발생했을 때, 계속해서 요청을 보내는 대신에 실패한 서비스와의 통신을 잠시 차단하여 재시도 시점을 결정하거나, 대체 로직을 통해 다른 작업을 수행할 수 있습니다.

서킷 브레이커의 동작 원리

서킷 브레이커는 3가지 상태로 동작합니다:

	1.	Closed (닫힘): 정상 상태로, 요청이 정상적으로 서비스에 전달되고 응답이 오고 있습니다.
	•	이 상태에서는 모든 요청이 정상적으로 처리되며, 오류율이 일정 임계치를 넘지 않습니다.
	2.	Open (열림): 요청이 일정 임계치 이상의 오류를 발생시키면, 서킷 브레이커가 열리고 더 이상의 요청을 차단합니다.
	•	이 상태에서는 서비스로의 요청이 바로 실패 처리되며, 서비스가 정상적으로 돌아오기까지 일정 시간 동안 요청을 보내지 않습니다.
	3.	Half-Open (반쯤 열림): 일정 시간 후 서킷 브레이커는 다시 테스트 요청을 소수만 보내서 서비스가 회복되었는지 확인합니다.
	•	이 상태에서는 소수의 요청만을 보내고, 서비스가 정상적으로 응답하면 Closed 상태로 돌아가고, 여전히 문제가 있으면 다시 Open 상태로 전환됩니다.

서킷 브레이커의 주요 목적:

	•	장애 전파 방지: 특정 서비스가 문제가 생기면, 그 서비스에 대한 모든 호출을 차단하여 시스템 전체로 장애가 확산되지 않도록 합니다.
	•	시스템 복구 시간 제공: 문제가 있는 서비스에 쉴 틈을 주어, 자동으로 복구될 시간을 제공할 수 있습니다.
	•	재시도 전략: 일정 시간이 지나면 다시 소수의 요청을 보내서 서비스가 복구되었는지 확인하는 방식으로 재시도를 수행합니다.

서킷 브레이커의 구조 예시:

	1.	Closed 상태: 모든 요청이 정상 처리.
	•	정상적인 요청 및 응답 처리.
	2.	Open 상태: 일정 오류 발생 시 요청 차단.
	•	계속된 오류로 인해 더 이상 요청을 보내지 않음.
	3.	Half-Open 상태: 테스트 요청을 소수만 보냄.
	•	시스템 상태를 확인하기 위해 소수의 요청만 보내고, 회복 여부를 테스트함.
